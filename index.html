<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>è‘¬å„€ãƒŸãƒ‹ã‚¢ãƒ—ãƒª</title>

  <style>
    :root{
      --bg:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --soft:#f9fafb;

      /* é«˜é½¢è€…é…æ…®ï¼šå¤§ãã‚ */
      --title:22px;
      --label:20px;
      --sub:14px;

      --radius:18px;
      --shadow: 0 10px 30px rgba(17,24,39,.08);
      --tap: 76px;
      --max: 520px;

      --blue:#2563eb;
      --ok:#16a34a;
      --primary:#111827;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans JP", sans-serif;
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .safe{
      padding:
        max(env(safe-area-inset-top), 18px)
        max(env(safe-area-inset-right), 18px)
        max(env(safe-area-inset-bottom), 18px)
        max(env(safe-area-inset-left), 18px);
    }

    .wrap{
      max-width: var(--max);
      margin: 0 auto;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 16px;
    }

    .app-title{
      font-size: var(--title);
      font-weight: 900;
      letter-spacing: .02em;
      line-height: 1.1;
    }

    .status{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 14px;
      border: 1px solid var(--line);
      background: var(--soft);
      border-radius: 999px;
      font-size: 13px;
      color: var(--muted);
      white-space:nowrap;
      font-weight: 800;
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background:#22c55e;
      box-shadow: 0 0 0 6px rgba(34,197,94,.12);
    }

    /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰ */
    .card{
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      background:#fff;
    }

    .card-hd{
      padding: 14px 16px;
      background: linear-gradient(180deg, #ffffff 0%, #fafafa 100%);
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .card-hd .h{
      font-size: 16px;
      font-weight: 900;
      color:#374151;
    }
    .pill{
      font-size: 12px;
      color: var(--muted);
      border: 1px solid var(--line);
      background:#fff;
      padding: 8px 10px;
      border-radius: 999px;
      font-weight: 800;
      white-space: nowrap;
    }

    .menu{
      display:flex;
      flex-direction:column;
    }

    /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ï¼šå¤§ãã„ã€æŠ¼ã—ã‚„ã™ã„ */
    .item{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      padding: 16px;
      min-height: var(--tap);
      text-decoration:none;
      color: var(--text);
      border-bottom: 1px solid var(--line);
      background:#fff;
    }
    .item:last-child{ border-bottom:none; }
    .item:active{ background:#f3f4f6; }

    .left{
      display:flex;
      align-items:center;
      gap:14px;
      min-width: 0;
    }

    .icon{
      width: 56px;
      height: 56px;
      border-radius: 18px;
      border: 1px solid var(--line);
      background: #fff;
      display:grid;
      place-items:center;
      box-shadow: 0 8px 18px rgba(17,24,39,.06);
      flex: 0 0 auto;
      font-size: 24px;
    }

    .text{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width: 0;
    }
    .text .label{
      font-size: var(--label);
      font-weight: 900;
      line-height: 1.15;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .text .sub{
      font-size: var(--sub);
      color: var(--muted);
      line-height: 1.2;
      font-weight: 800;
    }

    .chev{
      font-size: 26px;
      color: #9ca3af;
      flex: 0 0 auto;
    }

    /* ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ç›®ç«‹ãŸã› */
    .item.checkin .icon{
      border-color: rgba(22,163,74,.25);
      box-shadow: 0 10px 22px rgba(22,163,74,.10);
    }

    /* ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿ã‚¿ã‚° */
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:2px;
      font-size:12px;
      font-weight:900;
      color: var(--ok);
    }
    .tag .miniDot{
      width:8px;height:8px;border-radius:999px;background: var(--ok);
      box-shadow: 0 0 0 5px rgba(22,163,74,.12);
    }

    /* æ³¨è¨˜ï¼ˆå½“æ—¥ä»¥å¤– / ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å¾Œè¡¨ç¤ºãªã©ï¼‰ */
    .note-checkin{
      margin-top: 4px;
      font-size: 12px;
      font-weight: 800;
      color: #9ca3af;
      line-height: 1.2;
    }

    /* éæ´»æ€§ */
    .item.disabled{
      opacity: 0.45;
    }

    .footer{
      margin-top: 14px;
      text-align:center;
      font-size: 12px;
      color:#9ca3af;
      user-select:none;
    }

    @media (hover:hover){
      .item:hover{ background: #fafafa; }
      .item:hover .icon{ transform: translateY(-1px); }
    }
  </style>
</head>

<body>
  <div class="safe">
    <div class="wrap">

      <div class="header">
        <div class="app-title">è‘¬å„€ãƒŸãƒ‹ã‚¢ãƒ—ãƒª</div>
        <div class="status" aria-label="ç’°å¢ƒ">
          <span class="dot" id="dot"></span>
          <span id="env">DEV</span>
        </div>
      </div>

      <section class="card" aria-label="ãƒ›ãƒ¼ãƒ ">
        <div class="card-hd">
          <div class="h">ãƒ›ãƒ¼ãƒ </div>
          <div class="pill" id="openIn">WebView</div>
        </div>

        <nav class="menu">

          <!-- ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ï¼šå¸¸ã«è¡¨ç¤ºï¼ˆå½“æ—¥ä»¥å¤–ã¯éæ´»æ€§ï¼‹æ³¨è¨˜ï¼‰ -->
          <a class="item checkin" id="checkinItem" href="./checkin.html" aria-label="ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã¸">
            <div class="left">
              <div class="icon">âœ…</div>
              <div class="text">
                <div class="label" id="checkinLabel">ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³</div>
                <div class="sub" id="checkinSub">å½“æ—¥ã®å—ä»˜</div>

                <!-- å½“æ—¥ä»¥å¤–ã¯è¡¨ç¤º -->
                <div class="note-checkin" id="checkinNote" style="display:none;">
                  â€»å½“æ—¥ä»¥å¤–ã¯éè¡¨ç¤ºã«ãªã‚Šã¾ã™
                </div>

                <!-- ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿ã®ã¨ãè¡¨ç¤º -->
                <div class="tag" id="checkinTag" style="display:none;">
                  <span class="miniDot"></span>
                  <span>ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿</span>
                </div>
              </div>
            </div>
            <div class="chev">â€º</div>
          </a>

          <!-- ãƒã‚¤ãƒšãƒ¼ã‚¸ -->
          <a class="item" href="./mypage.html" aria-label="ãƒã‚¤ãƒšãƒ¼ã‚¸ã¸">
            <div class="left">
              <div class="icon">ğŸ‘¤</div>
              <div class="text">
                <div class="label">ãƒã‚¤ãƒšãƒ¼ã‚¸</div>
                <div class="sub">äºˆç´„æƒ…å ±ã®ç¢ºèª</div>
              </div>
            </div>
            <div class="chev">â€º</div>
          </a>

          <!-- ã‚ªãƒ¼ãƒ€ãƒ¼ï¼ˆãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹æƒ³å®šï¼šãƒ¢ãƒƒã‚¯ã§ã¯éæ´»æ€§ï¼‹æ³¨è¨˜ï¼‰ -->
          <a class="item" id="orderItem" href="./order.html" aria-label="ã‚ªãƒ¼ãƒ€ãƒ¼ã¸">
            <div class="left">
              <div class="icon">ğŸ›’</div>
              <div class="text">
                <div class="label">ã‚ªãƒ¼ãƒ€ãƒ¼</div>
                <div class="sub">å£²åº—</div>
                <div class="note-checkin" id="orderNote" style="display:none;">
                  â€»ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å¾Œã«è¡¨ç¤ºã•ã‚Œã¾ã™
                </div>
              </div>
            </div>
            <div class="chev">â€º</div>
          </a>

          <!-- é¤¨å†…ãƒãƒƒãƒ—ï¼ˆãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹æƒ³å®šï¼šãƒ¢ãƒƒã‚¯ã§ã¯éæ´»æ€§ï¼‹æ³¨è¨˜ï¼‰ -->
          <a class="item" id="mapItem" href="./map.html" aria-label="é¤¨å†…æ¡ˆå†…ã¸">
            <div class="left">
              <div class="icon">ğŸ—ºï¸</div>
              <div class="text">
                <div class="label">é¤¨å†…ãƒãƒƒãƒ—</div>
                <div class="sub">åœ°å›³ï¼å°ç·š</div>
                <div class="note-checkin" id="mapNote" style="display:none;">
                  â€»ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å¾Œã«è¡¨ç¤ºã•ã‚Œã¾ã™
                </div>
              </div>
            </div>
            <div class="chev">â€º</div>
          </a>

        </nav>
      </section>

      <div class="footer">Â©</div>
    </div>
  </div>

  <script>
    // ===== ç’°å¢ƒè¡¨ç¤ºï¼ˆngrok/localhostã–ã£ãã‚Šï¼‰ =====
    (function(){
      const h = location.hostname;
      const isNgrok = h.includes("ngrok");
      const isLocal = h === "localhost" || h === "127.0.0.1";
      document.getElementById("env").textContent = isNgrok ? "DEV / ngrok" : (isLocal ? "LOCAL" : "DEV");
      document.getElementById("dot").style.background = isLocal ? "#f59e0b" : "#22c55e";
      document.getElementById("dot").style.boxShadow = isLocal ? "0 0 0 6px rgba(245,158,11,.14)" : "0 0 0 6px rgba(34,197,94,.12)";
    })();

    // ===== èµ·å‹•ç’°å¢ƒï¼ˆLINE WebViewã£ã½ã„ã‹ï¼‰ =====
    (function(){
      const ua = navigator.userAgent || "";
      const inLine = ua.includes("Line") || ua.includes("LINE");
      document.getElementById("openIn").textContent = inLine ? "LINE" : "WebView";
    })();

    // ===== è¡¨ç¤ºåˆ¶å¾¡ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰=====
    // ãƒ»å½“æ—¥åˆ¤å®šï¼š?day=today ã§å½“æ—¥æ‰±ã„
    // ãƒ»ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿ï¼šlocalStorage "miniapp_checkin_done" ãŒã‚ã‚Œã°ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿æ‰±ã„
    (function(){
      const params = new URLSearchParams(location.search);
      const isTodayDemo = params.get("day") === "today";

      const checkinItem = document.getElementById("checkinItem");
      const checkinNote = document.getElementById("checkinNote");
      const checkinTag  = document.getElementById("checkinTag");

      const orderItem = document.getElementById("orderItem");
      const orderNote = document.getElementById("orderNote");
      const mapItem   = document.getElementById("mapItem");
      const mapNote   = document.getElementById("mapNote");

      // å½“æ—¥ä»¥å¤–ï¼šãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã¯éæ´»æ€§ï¼‹æ³¨è¨˜
      if(isTodayDemo){
        checkinItem.classList.remove("disabled");
        checkinItem.style.pointerEvents = "";
        checkinNote.style.display = "none";
      } else {
        checkinItem.classList.add("disabled");
        checkinItem.style.pointerEvents = "none";
        checkinNote.style.display = "";
      }

      // ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ¸ˆã¿ã‹ã©ã†ã‹
      let checkedIn = false;
      const raw = localStorage.getItem("miniapp_checkin_done");
      if(raw){
        try{
          JSON.parse(raw);
          checkedIn = true;
        }catch{}
      }

      if(checkedIn){
        checkinTag.style.display = "";
        document.getElementById("checkinSub").textContent = "å½“æ—¥QRã®ç¢ºèª";

        // ã‚ªãƒ¼ãƒ€ãƒ¼/é¤¨å†…ãƒãƒƒãƒ—ï¼šãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å¾Œã¯æ´»æ€§
        orderItem.classList.remove("disabled");
        orderItem.style.pointerEvents = "";
        orderNote.style.display = "none";

        mapItem.classList.remove("disabled");
        mapItem.style.pointerEvents = "";
        mapNote.style.display = "none";
      } else {
        // ã‚ªãƒ¼ãƒ€ãƒ¼/é¤¨å†…ãƒãƒƒãƒ—ï¼šãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å‰ã¯éæ´»æ€§ï¼‹æ³¨è¨˜
        orderItem.classList.add("disabled");
        orderItem.style.pointerEvents = "none";
        orderNote.style.display = "";

        mapItem.classList.add("disabled");
        mapItem.style.pointerEvents = "none";
        mapNote.style.display = "";
      }
    })();
  </script>
</body>
</html>
