<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>受付</title>

  <style>
    :root{
      --bg:#f6f7fb;          /* 背景を少し濃くしてカードを浮かせる */
      --card:#ffffff;
      --text:#0f172a;        /* 文字コントラストUP */
      --muted:#475569;
      --line:#d7dde5;        /* 線を少し濃く */
      --radius:18px;

      --shadow: 0 14px 36px rgba(15,23,42,.10);
      --shadowSoft: 0 10px 22px rgba(15,23,42,.08);

      --primary:#0f172a;
      --blue:#2563eb;
      --ok:#16a34a;
      --warn:#d97706;

      --soft:#f1f5f9;

      --title:20px;
      --label:18px;
      --sub:14px;
      --tap:64px;
    }

    * , *::before, *::after { box-sizing: border-box; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Noto Sans JP", sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    /* ===== 共通ヘッダー ===== */
    .header{
      height:68px;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      border-bottom:1px solid var(--line);
      padding:0 16px;
      background:#fff;
      position:sticky;
      top:0;
      z-index:10;
    }
    .header-title{
      grid-column:2;
      font-size:22px;
      font-weight:1000;
      letter-spacing:.02em;
      text-align:center;
    }
    .header-home{
      grid-column:3;
      justify-self:end;
      font-size:18px;
      font-weight:1000;
      text-decoration:none;
      color: var(--blue);
      padding:10px 12px;
      border-radius:12px;
    }
    .header-home:active{ background:#eff6ff; }

    /* ===== コンテンツ ===== */
    .wrap{
      max-width:560px;
      margin:0 auto;
      padding:18px 16px 28px;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .card{
      border:2px solid var(--line);      /* 太め枠 */
      border-radius:var(--radius);
      padding:18px;
      background: var(--card);
      box-shadow: var(--shadow);
    }

    .card-title{
      font-size:var(--title);
      font-weight:1000;
      margin:0 0 14px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .card-title::before{
      content:"";
      width:10px;
      height:22px;
      border-radius:999px;
      background: var(--blue);           /* 見出しを目立たせる */
      box-shadow: 0 0 0 6px rgba(37,99,235,.10);
    }

    /* ステータス */
    .status-pill{
      position:relative;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:16px 14px 16px 16px;
      border-radius:16px;
      border:2px solid var(--line);      /* 太め枠 */
      background: var(--soft);
    }

    /* 左の色バーで一発で状態が分かる */
    .status-pill::before{
      content:"";
      position:absolute;
      left:0;
      top:10px;
      bottom:10px;
      width:8px;
      border-radius:999px;
      background: var(--warn);
    }
    .pill-ok::before{ background: var(--ok); }

    .status-left{
      display:flex;
      align-items:flex-start;
      gap:12px;
      min-width:0;
    }
    .dot{
      width:16px;height:16px;border-radius:999px; flex:0 0 auto;
      margin-top:4px;
      background: var(--warn);
      box-shadow: 0 0 0 8px rgba(217,119,6,.16);
    }
    .pill-ok .dot{
      background: var(--ok);
      box-shadow: 0 0 0 8px rgba(22,163,74,.16);
    }

    .status-text{
      font-size:20px;          /* 大きく */
      font-weight:1100;
      letter-spacing:.02em;
      line-height:1.2;
      margin-bottom:4px;
    }
    .status-sub{
      font-size:var(--sub);
      color:var(--muted);
      font-weight:900;
      line-height:1.7;
    }

    .status-meta{
      text-align:right;
      font-size:13px;
      color:var(--muted);
      font-weight:900;
      line-height:1.35;
      flex:0 0 auto;
      padding-left:10px;
    }
    .status-meta strong{
      display:block;
      color:var(--text);
      font-size:14px;
      font-weight:1000;
      margin-top:2px;
    }

    .btns{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:14px;
    }

    .btn{
      appearance:none;
      border:0;
      cursor:pointer;
      border-radius:18px;
      padding:18px 18px;
      font-weight:1100;
      font-size:20px;          /* 目立たせる */
      min-height:var(--tap);
      box-shadow: var(--shadowSoft);
      background: linear-gradient(180deg, #111827 0%, #0b1220 100%);
      color:#fff;
      text-align:center;
      letter-spacing:.02em;
    }
    .btn:active{ transform: translateY(1px); }

    .btn.secondary{
      background:#fff;
      color: var(--text);
      border:2px solid var(--line);
      box-shadow:none;
      font-weight:1000;
      font-size:16px;
      min-height:56px;
    }

    .hint{
      margin-top:12px;
      font-size:14px;
      color:var(--muted);
      font-weight:900;
      line-height:1.7;
    }

    /* 小さい画面でも読みやすく */
    @media (max-width: 360px){
      .status-text{ font-size:19px; }
      .btn{ font-size:19px; }
    }
  </style>
</head>

<body>
  <header class="header">
    <div></div>
    <div class="header-title">受付</div>
    <a class="header-home" href="./index.html">ホーム</a>
  </header>

  <div class="wrap">
    <section class="card">
      <div class="card-title">受付状態</div>

      <div id="statusPill" class="status-pill pill-warn">
        <div class="status-left">
          <span class="dot" aria-hidden="true"></span>
          <div>
            <div id="statusText" class="status-text">受付してください</div>
            <div id="statusSub" class="status-sub">
              受付で案内があった方は「受付する」を押してください
            </div>
          </div>
        </div>

        <div class="status-meta">
          <div>受付時刻</div>
          <strong id="checkedAt">—</strong>
        </div>
      </div>

      <div class="btns">
        <button class="btn" id="checkinBtn" type="button">受付する</button>
        <button class="btn secondary" id="resetBtn" type="button" style="display:none;">受付前に戻す（モック）</button>
      </div>

      <div class="hint">
        ※「受付する」を押すとホーム画面へ移動します。
      </div>
    </section>
  </div>

  <script>
    const LS_KEY = "miniapp_reception_done";

    const statusPill = document.getElementById("statusPill");
    const statusText = document.getElementById("statusText");
    const statusSub  = document.getElementById("statusSub");
    const checkinBtn = document.getElementById("checkinBtn");
    const resetBtn   = document.getElementById("resetBtn");
    const checkedAt  = document.getElementById("checkedAt");

    function pad(n){ return String(n).padStart(2,"0"); }
    function nowText(){
      const now = new Date();
      return `${now.getFullYear()}/${pad(now.getMonth()+1)}/${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}`;
    }

    function saveDone(ts){
      localStorage.setItem(LS_KEY, JSON.stringify({ receivedAt: ts }));
    }
    function clearDone(){
      localStorage.removeItem(LS_KEY);
    }

    function setDoneUI(ts){
      statusPill.classList.remove("pill-warn");
      statusPill.classList.add("pill-ok");
      statusText.textContent = "受付完了";
      statusSub.textContent  = "受付が完了しました。ホーム画面から操作を続けてください。";
      checkedAt.textContent = ts;

      checkinBtn.style.display = "none";
      resetBtn.style.display   = "block";
    }

    function setNotDoneUI(){
      statusPill.classList.remove("pill-ok");
      statusPill.classList.add("pill-warn");
      statusText.textContent = "受付してください";
      statusSub.textContent  = "受付で案内があった方は「受付する」を押してください";
      checkedAt.textContent = "—";

      checkinBtn.style.display = "block";
      resetBtn.style.display   = "none";
    }

    (function init(){
      const raw = localStorage.getItem(LS_KEY);
      if(!raw){ setNotDoneUI(); return; }
      try{
        const data = JSON.parse(raw);
        if(data && data.receivedAt){
          setDoneUI(data.receivedAt);
        }else{
          setNotDoneUI();
        }
      }catch{
        setNotDoneUI();
      }
    })();

    checkinBtn.addEventListener("click", ()=>{
      const ts = nowText();
      saveDone(ts);
      setDoneUI(ts);
      window.location.href = "./index.html";
    });

    resetBtn.addEventListener("click", ()=>{
      clearDone();
      setNotDoneUI();
      alert("受付前に戻しました（モック）。");
    });
  </script>
</body>
</html>
